<!DOCTYPE html>
<ui:composition template="WEB-INF/template.xhtml" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:p="http://primefaces.org/ui">

	<ui:define name="title">Featured</ui:define>

	<ui:define name="content">

		<f:metadata>
			<f:viewParam name="user" value="#{featuredPresentationsController.userParameter}" />
			<f:viewAction action="#{featuredPresentationsController.init}" />
		</f:metadata>

		<ui:param name="_controller" value="#{featuredPresentationsController}" />

		<h:form id="featuredPresentationsFilterForm">
			<p:autoComplete id="categoryAutocomplete" placeholder="Categories filter..." value="#{_controller.categories}"
				var="category" multiple="true" converter="presentationCategoryConverter" itemLabel="#{category.label}"
				itemValue="#{category}" completeMethod="#{_controller.completeCategory}" forceSelection="true" minQueryLength="0"
				maxResults="100" widgetVar="categoryAutocompleteWV">
				<p:ajax event="itemSelect" listener="#{_controller.onCategorySelect}" process="@this" update=":featuredPresentationsDataForm" />
				<p:ajax event="itemUnselect" listener="#{_controller.onCategoryUnselect}" process="@this" update=":featuredPresentationsDataForm" />
				<p:column>
					<h:outputText value="#{category.label}" />
				</p:column>
			</p:autoComplete>
		</h:form>
		<h:form id="featuredPresentationsDataForm" style="margin-top: 5px;">
			<p:dataScroller value="#{_controller.presentations}" var="presentation" lazy="true" chunkSize="10">
				<h:panelGrid columns="2" columnClasses="column-20,column-80 top" styleClass="eprez-border" style="margin: 10px; padding: 10px;">
					<p:outputPanel layout="block">
						<img src="#{request.contextPath}/image?id=#{presentation.id}&amp;placeholder=1" class="eprez-featured-image" />
					</p:outputPanel>
					<p:outputPanel layout="block" style="margin-left: 10px;">
						<h:panelGrid columns="1" cellpadding="5">
							<h:outputLink value="view-presentation.xhtml">
								<h:outputText value="#{presentation.name}" styleClass="big" />
								<f:param name="id" value="#{presentation.id}" />
							</h:outputLink>
							<h:outputText value="#{presentation.description == null ? '' : presentation.description.substring(0, 500)}..."
								styleClass="small" />
						</h:panelGrid>
					</p:outputPanel>
				</h:panelGrid>
			</p:dataScroller>
		</h:form>

	</ui:define>

</ui:composition>
